AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: >
  Sample SAM Template for aws-dotnet-textract

Parameters:
  Environment:
    Type: String
    Default: dev
    AllowedValues:
      - dev
      - test
      - prod


Globals:
  # Global attributes for each function
  Function:
    Timeout: 10
    Runtime: dotnet6
    MemorySize: 256
    Architectures:
      - arm64    
    



Resources:
#Functions
  SendToTextract:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: SendToTextract
      CodeUri: ./src/ServerlessTextToSpeech.SendToTextract
      Handler: ServerlessTextToSpeech.SendToTextract
  PublishMetaData:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: PublishMetaData
      CodeUri: ./src/ServerlessTextToSpeech.PublishMetaData
      Handler: ServerlessTextToSpeech.PublishMetaData
  ProcessText:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: ProcessText
      CodeUri: ./src/ServerlessTextToSpeech.ProcessText
      Handler: ServerlessTextToSpeech.ProcessText

#S3 buckets
  SourceBucket:
    Type: AWS::S3::Bucket
    Properties:
      BucketName:
        Fn::Join
          - 'serverles-source-data-'
          - !Ref Environment
  OutputBucket:
    Type: AWS::S3::Bucket
    Properties:
      BucketName:
        Fn::Join
          - 'serverles-output-data-'
          - !Ref Environment

#Database
  MetaDataTable:
    Type: AWS::Serverless::SimpleTable
    Properties:
      TableName: 
        Fn::Join
          - 'serverless-data-'
          - !Ref Environment

#Step FUnction
  ProcessWorkflow:
    Type: AWS::StepFunctions::StateMachine
    Properties:
      StateMachineType: XXX
      Definition: ./
        





